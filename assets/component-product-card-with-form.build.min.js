!function(){"use strict";const t={card:".js-product-card",form:".js-product-card-form",imageWrapper:".js-product-card-form-images-wrapper",price:".js-price",button:".js-product-card-button",product:".js-product-card-product",variantElemJSON:"[data-selected-variant]",option:"select[data-option], [data-option]:checked",hiddenInput:".js-product-card-variant-input",swatches:"[data-option-index]",formError:".js-product-card-error",checkmark:".js-product-card-checkmark",minQuantity:".js-product-card-min-value"};var e=()=>{const e=window.themeCore.utils.cssClasses;async function r(r){const a=r.target.closest(t.form);if(!a)return;const i=a.closest(t.card);if(!i)return;const c=i.dataset.section,s=[...i.querySelectorAll(t.imageWrapper)],d=a.querySelector(t.swatches),u=d&&d.dataset.optionIndex;let l=[...a.querySelectorAll(t.option)];const m=i.querySelector(t.price);let p=a.querySelector(t.button);p&&p.classList.contains(e.hidden)&&(p=null);const f=function(t){try{return JSON.parse(t.textContent)}catch{return null}}(a.querySelector(t.product)),w=i.querySelectorAll(t.checkmark),h=a.querySelector(t.formError);if(!f)return;if("SELECT"===r.target.tagName&&r.target.selectedOptions.length&&(Array.from(r.target.options).find(t=>t.getAttribute("selected")).removeAttribute("selected"),r.target.selectedOptions[0].setAttribute("selected","selected")),!((!u||l.some(t=>t.name===u))&&l.every(t=>t.value)))return;i&&i.classList.add(e.active),w.length&&w.forEach(t=>t.classList.add(e.active));const y=a.querySelector(t.hiddenInput),v=i.getAttribute("data-product-url");await async function(e,r){if(!e||!r)return;const n=Array.from(e.querySelectorAll("select[data-option] option[selected], input[data-option]:checked")).map(({dataset:t})=>t.optionValueId),a=n.length>0?`&option_values=${n.join(",")}`:"",i=`${r}?section_id=product-bundle-card${a}`,c=await o(i,t.variantElemJSON),s=e.querySelector(t.variantElemJSON);s&&(s.innerHTML=c.innerHTML)}(a,v);const S=function(e){if(!e)return;const r=e.querySelector(t.variantElemJSON);return r?JSON.parse(r.innerHTML):null}(a);S?(n(S.id,y),function(t,r){if(!t)return;r.some(e=>e.dataset.imageId.includes(String(t.id)))&&r.forEach(r=>{r.dataset.imageId.includes(String(t.id))?r.classList.add(e.active):r.classList.remove(e.active)})}(S.featured_image,s),await async function(e,r,n){if(!n)return;const a=function(t,e,r){if(!t)return;const n=window.Shopify.routes.root,o=new URL(`${window.location.origin}${n}products/${t}`);o.searchParams.set("view",r),e&&o.searchParams.set("variant",e);return o}(e,r,"price").toString();if(!a)return;const i=await o(a,t.fetchPrice);n.innerHTML=i.querySelector(t.price)&&i.querySelector(t.price).outerHTML}(f.handle,S.id,m)):(n("",y),function(t){if(!t)return;t.innerHTML=""}(m)),function(e,r){if(!r)return;const n=!r.matches(t.button);e?e.available?r.innerHTML=n?"":window.themeCore.translations.get("products.product.add_to_cart"):r.innerHTML=window.themeCore.translations.get("products.product.sold_out"):r.innerHTML=window.themeCore.translations.get("products.product.unavailable");if(n)return;r.disabled=!e||!e.available}(S,p||h),window.themeCore.EventBus.emit("product-card:change-variant",{sectionId:c})}function n(t,e){e&&(e.value=t)}async function o(t,e){try{const r=await fetch(t),n=await r.text();let o=(new DOMParser).parseFromString(n,"text/html");return e&&(o=o.querySelector(e)),o}catch(t){console.error(t)}}async function a(e){const r=e.target.closest(t.form),n=r&&new FormData(r),o=r&&r.querySelector(t.hiddenInput),a=r&&r.querySelector(t.minQuantity),i=o&&o.value,c=a?Number(a.value):1;if(!n||!i)return;e.preventDefault();const s=await async function(t,e){try{await window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.ADD_TO_CART,{id:t,quantity:e})}catch(t){return t.description}}(i,c);!function(e,r=""){const n=e&&e.querySelector(t.formError);if(!n)return;n.innerText=r}(r,s),s&&window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.GET_CART)}return Object.freeze({init:function(){document.addEventListener("change",r),document.addEventListener("submit",a)}})};const r=()=>{window.themeCore.ProductCardWithForm=window.themeCore.ProductCardWithForm||e(),window.themeCore.utils.register(window.themeCore.ProductCardWithForm,"product-card-with-banner")};window.themeCore&&window.themeCore.loaded?r():document.addEventListener("theme:all:loaded",r,{once:!0})}();